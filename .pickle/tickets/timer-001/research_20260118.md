# Research: Implement God Mode Pomodoro Timer & Subtask State Linkage

**Date**: 2026-01-18

## 1. Executive Summary
The Pomodoro timer requires a bidirectional link with the subtask state. Starting a timer on a subtask must set that subtask as "active/focused," and completing that subtask must terminate the active timer. Current state is centralized in `App.jsx`, making it the ideal location for the "Active Subtask" logic.

## 2. Technical Context
- **State Location**: `src/App.jsx` manages `todos` and subtask mutations.
- **Components**:
    - `TodoItem.jsx` renders `SubTaskItem` components.
    - `SubTaskItem.jsx` (Lines 4-33) handles subtask clicks via the `onToggle` prop.
- **Logic Flow**:
    - `App.toggleSubTask` (Lines 68-81) updates the `completed` status of a subtask.

## 3. Findings & Analysis
- **Active Task State**: We need a new state variable in `App.jsx`: `activeSubTask` (object containing `{ todoId, subTaskId }`).
- **Timer Integration**:
    - A `PomodoroTimer` component will be rendered in the `right-segment`.
    - It will receive the `activeSubTask` and a `onTimerComplete` or `onStop` callback.
- **Linking Mechanism**:
    - Add a "Focus" icon/button to `SubTaskItem`.
    - Clicking "Focus" updates `activeSubTask` in `App.jsx`.
    - `toggleSubTask` in `App.jsx` will check if `subTaskId === activeSubTask.subTaskId`. If true and `completed` becomes true, the timer state must be reset.

## 4. Technical Constraints
- **State Sync**: Timer must respond immediately to state changes in the todo list.
- **Aesthetic**: Timer must use hand-drawn assets or fonts to match the "Paper" theme.

## 5. Architecture Documentation
- Pattern: Lifting state to the common ancestor (`App`) to allow sibling components (`TodoList` and `PomodoroTimer`) to communicate.
