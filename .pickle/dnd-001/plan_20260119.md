# Fix Drag and Drop Interaction Failure Implementation Plan

## Overview
Fix the issue where tasks and subtasks are "draggable" but cannot be "dropped" (reordered). This is primarily caused by event stealing from nested `button` elements and potentially layout issues with `Droppable` containers.

## Current State Analysis
- `TaskSidebar.jsx`: The `Draggable` contains a `button` as the primary child. `react-beautiful-dnd` often fails when `button` elements are used as drag handles or are the primary interaction point within a draggable.
- `TodoItem.jsx`: Nested `Draggable` items wrap `SubTaskItem`.
- `SubTaskItem.jsx`: Uses a `button` for the task text.
- `App.jsx`: `DragDropContext` wraps everything, which is correct, but reordering logic might be failing if IDs are mismatched.

## Implementation Approach
1. Refactor `TaskSidebar.jsx`: Change the task `button` to a `div` with `onClick` and `role="button"`. Move `dragHandleProps` explicitly to this element.
2. Refactor `TodoItem.jsx` / `SubTaskItem.jsx`: Similar refactor. Ensure the `Draggable` wrapper doesn't have its events intercepted.
3. Add a dedicated "drag handle" icon/area to make it clear where to grab, which also avoids accidental clicks during drag.
4. Ensure `Droppable` containers have a `min-height: 100px` (or similar) to ensure they are always valid targets.

## Phase 1: Sidebar Refactor
### Overview
Remove `button` element from `TaskSidebar` draggable items.

### Changes Required:
#### 1. `src/TaskSidebar.jsx`
**Changes**:
- Change `<button>` to `<div role="button">`.
- Keep existing styles.
- Add `userSelect: 'none'` to prevent text selection during drag.

```jsx
<div
  role="button"
  onClick={() => onSelectTodo(todo.id)}
  style={{
    // ... previous button styles ...
    userSelect: 'none',
    cursor: 'grab'
  }}
>
```

## Phase 2: Subtask Refactor
### Overview
Fix subtask draggables in `TodoItem.jsx` and `SubTaskItem.jsx`.

### Changes Required:
#### 1. `src/SubTaskItem.jsx`
**Changes**:
- Change the task text `<button>` to a `<span>` or `<div>` with `onClick`.
- This prevents the button from swallowing drag events.

## Phase 3: Layout & Logic Verification
### Overview
Ensure `Droppable` areas are reachable and logic is solid.

### Changes Required:
#### 1. `src/index.css`
**Changes**:
- Ensure `.sidebar-list` and `.sub-tasks-list` have `min-height: 50px`.

### Success Criteria:
#### Manual:
- [ ] Sidebar tasks can be dragged and dropped to reorder.
- [ ] Subtasks can be dragged and dropped to reorder.
- [ ] No snap-back without reorder.
- [ ] Console log 'Drag ended' shows valid destination in `App.jsx`.
```jsx
// Log verification added in research phase will help here.
```